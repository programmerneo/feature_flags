$comet-background-color-global-nav = $comet-color-neutral-15;
$comet-background-color-util-links = #0B0C0F;
$comet-background-color-link-global-nav-bar-hover = $comet-color-neutral-25;
$comet-background-color-link-global-nav-bar-active = $comet-color-neutral-22;
$comet-customization-panel-background = #13141A;
$comet-font-size-more-nav-header-text = $comet-font-size-pill;
$comet-color-nav-text = $comet-color-neutral-80;
$comet-color-nav-text-hover = $comet-color-white;
$comet-background-color-selected-item = $comet-color-neutral-25;

.comet-global-nav-bar {
    text-body();
    background: $comet-background-color-global-nav;
    display: flex;
    flex-direction: column;
    position: relative;
    width: 100%;
    
    // Icons have to be nested inside .comet-global-nav-bar to have enough specificity to override comet-list-group
    .comet-global-nav-bar__item-icon {
        pointer-events: none;
        height: $comet-size-icon-l;
        fill: $comet-color-neutral-65;
        flex: 0 0 $comet-size-icon-l;
        margin-bottom: -6px; // "shrink" height of icon so it takes up no more space than the text which is 12px tall. Icons are 24px tall so we're shaving 6px off the top and bottom
        margin-top: -6px; // "shrink" height of icon so it takes up no more space than the text which is 12px tall. Icons are 24px tall so we're shaving 6px off the top and bottom
        transition: fill comet-page-shell-transition-snap(); // Sadly this transition doesn't work in Safari since the SVG is inside a link, won't fix for now

        .comet-page-shell--global-nav-bar-expanded &,
        .comet-page-shell--global-nav-bar-expanded-always &,
        .comet-page-shell--global-nav-bar-customizing & {
            fill: $comet-color-nav-text;
            transition: fill comet-page-shell-transition-reveal(); // Sadly this transition doesn't work in Safari since the SVG is inside a link, won't fix for now
        }
    }
    
    // Selected state theme colors have to be nested inside .comet-global-nav-bar to have enough specificity to override comet-list-group styles
    &.comet-global-nav-bar--theme-product-science {
        .comet-global-nav-bar__item--selected:before {
            background-color: $comet-theme-product_science-color-light;
        }
    }

    &.comet-global-nav-bar--theme-product-math {
        .comet-global-nav-bar__item--selected:before {
            background-color: $comet-theme-product_math-color-light;
        }
    }

    &.comet-global-nav-bar--theme-product-social-studies {
        .comet-global-nav-bar__item--selected:before {
            background-color: $comet-theme-product_social_studies-color-light;
        }
    }

    &.comet-global-nav-bar--theme-product-streaming {
        .comet-global-nav-bar__item--selected:before {
            background-color: $comet-theme-product_streaming-color-light;
        }
    }
    
    // Selected state modifier colors have to be nested inside .comet-global-nav-bar to have enough specificity to override comet-list-group styles
    .comet-global-nav-bar__item--selected {
        background-color: $comet-background-color-selected-item;
        
        &:hover {
            .comet-global-nav-bar__item-label {
                color: $comet-color-nav-text-hover;
            }
        }
        
        &.comet-global-nav-bar__item--draggable:hover:before {
            // Remove "selected" indicator color bar so draggable handle can be revealed
            width: 0;
        }
        
        .comet-page-shell--global-nav-bar-customizing &:before {
            width: 0;
        }
    }
}

.comet-global-nav-bar__list-group {
    background: $comet-background-color-global-nav;
    flex-shrink: 0;
}

.comet-global-nav-bar__header {
    align-items: center;
    color: $comet-color-white;
    display: flex;
    flex-shrink: 0;
    margin-top: $comet-space-default;
    padding: $comet-space-inset-default;
    padding-bottom: 0;
    padding-top: 0;
    
    &:hover {
        background: $comet-background-color-link-global-nav-bar-hover;
    }
    
    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        padding-left: $comet-space-s;
        transition: padding comet-page-shell-transition-snap($comet-page-shell-transition-duration-s);
        
        .comet-page-shell--global-nav-bar-expanded &,
        .comet-page-shell--global-nav-bar-expanded-always &,
        .comet-page-shell--global-nav-bar-customizing & {
            padding-left: $comet-space-default;
            transition: padding comet-page-shell-transition-reveal($comet-page-shell-transition-duration-m);
        }
    }
}

.comet-global-nav-bar__brand-logo-wrap {
    height: 63px;
    position: relative;
    width: 100%;
}

.comet-global-nav-bar__item-sort-placeholder {
    background: $comet-customization-panel-background;
    min-height: 56px;
    width: 100%;
}

.comet-global-nav-bar__item--sorting .comet-global-nav-bar__item-icon,
.comet-global-nav-bar__link:hover .comet-global-nav-bar__item-icon {
    fill: $comet-color-nav-text-hover;
}

// Nested selector to override comet list group dark theme default
.comet-global-nav-bar {
    .comet-global-nav-bar__item-label {
        vertical-text-crop();
        color: $comet-color-nav-text;
    }

    .comet-global-nav-bar__item--sorting .comet-global-nav-bar__item-label,
    .comet-global-nav-bar__link:hover .comet-global-nav-bar__item-label {
        color: $comet-color-nav-text-hover;
    }
}

.comet-global-nav-bar__customize-panel {
    background: $comet-customization-panel-background;
    box-shadow: 0 40px 0 $comet-customization-panel-background;
    flex-shrink: 0;
    margin-bottom: 40px;
    margin-top: auto;
    overflow: hidden;

    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        margin-bottom: 0;
        opacity: 0;
        transition: opacity comet-page-shell-transition-snap();
        
        .comet-page-shell--global-nav-bar-expanded &,
        .comet-page-shell--global-nav-bar-expanded-always &,
        .comet-page-shell--global-nav-bar-customizing & {
            opacity: 1;
            transition: opacity comet-page-shell-transition-reveal();
        }
    }
}

.comet-global-nav-bar__customize-panel-actions {
    height: 0;
    min-height: 0;
    overflow: hidden;
    text-align: center;
    transition: min-height comet-page-shell-transition-snap();

    .comet-page-shell--global-nav-bar-customizing & {
        min-height: 120px;
        transition: min-height comet-page-shell-transition-reveal();
    }
}

.comet-global-nav-bar__customization-trigger {
    align-items: center;
    border-radius: 0;
    display: flex;
    justify-content: center;
    padding-right: 36px;
    text-decoration: none;
    transition: background $comet-transition-default;
    width: 100%;
    
    &:hover {
        background: $comet-background-color-selected-item;
    }
    
    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        height: auto;
    }
}

.comet-global-nav-bar__customization-icon {
    fill: $comet-color-nav-text;
    transition: transform comet-page-shell-transition-snap();

    .comet-global-nav-bar__customization-trigger:hover & {
        fill: $comet-color-nav-text-hover;
    }
    
    .comet-page-shell--global-nav-bar-customizing & {
        transform: rotate(180deg);
        transition: transform comet-page-shell-transition-reveal();
    }
    
    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        transform: rotate(180deg);
        
        .comet-page-shell--global-nav-bar-expanded &,
        .comet-page-shell--global-nav-bar-expanded-always & {
            transform: rotate(0deg);
            transition: transform comet-page-shell-transition-reveal();
        }
        
        // Repeat this rule so it still applies when the nav is expanded
        .comet-page-shell--global-nav-bar-customizing & {
            transform: rotate(180deg);
            transition: transform comet-page-shell-transition-reveal();
        }
    }
}

.comet-global-nav-bar__customization-text {
    color: $comet-color-nav-text;
    margin-left: $comet-space-xs;
    text-decoration: none;

    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        position: relative;
        left: $comet-space-l;
        transition: left comet-page-shell-transition-snap();
        
        .comet-page-shell--global-nav-bar-expanded &,
        .comet-page-shell--global-nav-bar-expanded-always &,
        .comet-page-shell--global-nav-bar-customizing & {
            left: 0;
            transition: left comet-page-shell-transition-reveal($comet-page-shell-transition-duration-m, $comet-page-shell-transition-duration-xs);
        }
    }
}

.comet-global-nav-bar__reset-menu {
    background: transparent;
    border-radius: 0;
    width: 100%;
    transition: background $comet-transition-default;
    
    &:hover {
        background: $comet-background-color-selected-item;
    }
}

.comet-global-nav-bar__customize-panel-save {
    padding: $comet-space-inset-default;

    .comet-button:last-child {
        margin-right: 0;
    }
}

// Extra specificity to overcome display: flex on list group
.comet-global-nav-bar .comet-global-nav-bar__item--home {
    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        display: none;
    }
}

.comet-global-nav-bar__brand-logo-small {
    height: 0;
    left: 0;
    overflow: hidden;
    position: absolute;
    top: 0;
    transition: opacity comet-page-shell-transition-snap($comet-page-shell-transition-duration-s, $comet-page-shell-transition-duration-xs);
    visibility: hidden;
    width: 40px;
    z-index: 0;

    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        height: auto;
        opacity: 1;
        top: 10px;
        transition: opacity comet-page-shell-transition-reveal($comet-page-shell-transition-duration-m, $comet-page-shell-transition-duration-xs);
        visibility: visible;
    }
}

.comet-global-nav-bar__brand-logo-full {
    left: 0;
    position: absolute;
    top: 10px;
    width: 185px;
    
    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        opacity: 0;
        overflow: hidden;
        transition: opacity comet-page-shell-transition-snap($comet-page-shell-transition-duration-s, $comet-page-shell-transition-duration-xs);
        z-index: 5;
        
        .comet-page-shell--global-nav-bar-expanded &,
        .comet-page-shell--global-nav-bar-expanded-always &,
        .comet-page-shell--global-nav-bar-customizing & {
            opacity: 1;
            transition: opacity comet-page-shell-transition-reveal($comet-page-shell-transition-duration-m, $comet-page-shell-transition-duration-xs);
        }
    }
}

.comet-global-nav-bar__item-label {
    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        opacity: 0;
        left: $comet-space-default;
        position: relative;
        transition: opacity comet-page-shell-transition-snap($comet-page-shell-transition-duration-s), left comet-page-shell-transition-snap($comet-page-shell-transition-duration-s);
        
        .comet-page-shell--global-nav-bar-expanded &,
        .comet-page-shell--global-nav-bar-expanded-always &,
        .comet-page-shell--global-nav-bar-customizing & {
            left: 0;
            opacity: 1;
            transition: opacity comet-page-shell-transition-reveal($comet-page-shell-transition-duration-m, $comet-page-shell-transition-duration-xs), left comet-page-shell-transition-reveal($comet-page-shell-transition-duration-m, $comet-page-shell-transition-duration-xs);
        }
    }
}

.comet-global-nav-bar__item.comet-global-nav-bar__item--sorting {
    background: $comet-background-color-link-global-nav-bar-hover;
}

// Triple selector to override specificity of .comet-list-group--row-inset-m .comet-list-group__row-anchor
.comet-global-nav-bar .comet-global-nav-bar__item .comet-global-nav-bar__link {
    @media screen and (min-width: $comet-breakpoints-tablet-portrait) {
        padding-left: $comet-space-default + 3px;
        transition: padding comet-page-shell-transition-snap($comet-page-shell-transition-duration-s);
        
        .comet-page-shell--global-nav-bar-customizing &,
        .comet-page-shell--global-nav-bar-expanded &,
        .comet-page-shell--global-nav-bar-expanded-always & {
            padding-left: $comet-space-default;
            transition: padding comet-page-shell-transition-reveal($comet-page-shell-transition-duration-m);
        }
    }
}

.comet-global-nav-bar__more-items {
    
    .comet-global-nav-bar__item .comet-global-nav-bar__item-icon {
        opacity: 0;
        transition: opacity comet-page-shell-transition-snap($comet-page-shell-transition-duration-s);
 
        &.comet-global-nav-bar__item--sorting {
            transition: none;
            transition: opacity comet-page-shell-transition-snap($comet-page-shell-transition-duration-s);
        }
    }
    
    .comet-page-shell--global-nav-bar-expanded-always &,
    .comet-page-shell--global-nav-bar-expanded &,
    .comet-page-shell--global-nav-bar-visible &  {
        
        .comet-global-nav-bar__item .comet-global-nav-bar__item-icon {
            opacity: 1;
            transition: opacity comet-page-shell-transition-reveal($comet-page-shell-transition-duration-m);
     
            &.comet-global-nav-bar__item--sorting {
                transition: none;
            }
        }
    }
}

.comet-global-nav-bar__more-nav-header {
    opacity: 0
    border-top: 1px solid $comet-color-nav-text-hover;
    margin: 0 $comet-space-default+20 $comet-space-default $comet-space-default
    transition: opacity comet-page-shell-transition-reveal($comet-page-shell-transition-duration-s);

    .comet-page-shell--global-nav-bar-expanded-always &,
    .comet-page-shell--global-nav-bar-expanded &,
    .comet-page-shell--global-nav-bar-visible & {
        opacity: 1
        transition: opacity comet-page-shell-transition-reveal($comet-page-shell-transition-duration-l);
    }
}

.comet-global-nav-bar__customize-sortable-target {
    align-items: center;
    display: flex;
    flex-shrink: 0;
    margin: $comet-space-inline-left-xs;
    
    .comet-page-shell--global-nav-bar-customizing & {
        cursor: grab;
    }
}

.comet-global-nav-bar__item-grip-wrap {
    cursor: grab;
    display: flex;
    flex: 0 0 $comet-size-icon-s;
    fill: $comet-color-white;
    margin-left: -($comet-size-icon-s); // "pull" to the left the same distance as the icon's width;
    opacity: 0;
    visibility: hidden;
    transition opacity comet-page-shell-transition-snap(), visibility comet-page-shell-transition-snap(0, $comet-page-shell-transition-duration-default); // Wait to change visibility until after opacity fades out

    .comet-global-nav-bar__item--sorting &,
    .comet-global-nav-bar__link:hover & {
        align-items: center;
        display: flex;
        opacity: 1;
        transition: none;
        visibility: visible;
    }
    
    .comet-page-shell--global-nav-bar-customizing & {
        display: flex;
        opacity: 1;
        transition opacity comet-page-shell-transition-reveal();
        visibility: visible;
    }
}

.comet-global-nav-bar__item-grip-icon {
    width: $comet-size-icon-s;
    height: $comet-size-icon-s;
    
    margin-bottom: -2px; // "shrink" height of icon so it takes up no more space than the text which is 12px tall. Icons are 16px tall so we're shaving 2px off the top and bottom
    margin-top: -2px; // "shrink" height of icon so it takes up no more space than the text which is 12px tall. Icons are 16px tall so we're shaving 2px off the top and bottom
}

.comet-global-nav-bar__item--sorting {
    .comet-global-nav-bar__item-grip-wrap,
    .comet-global-nav-bar__link {
        cursor: grabbing;
    }
}

.comet-global-nav-bar__items--more-hidden-dropzone {
    min-height: 56px;
    margin: 0;
    padding: 0;
    
    .comet-page-shell--global-nav-bar-expanded-always &,
    .comet-global-nav-bar--more-nav-expanded & {
        display: none;
    }
}
